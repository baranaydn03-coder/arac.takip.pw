<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Araç Takip</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; background:#f4f4f4; }
h1 { text-align:center; }
input, button { padding: 10px; margin: 5px; }
#aracListesi { margin-top:20px; }
.arac { background:#fff; padding:10px; margin-bottom:10px; border-radius:5px; }
.kalan { font-weight:bold; color:green; }
.uyari { color:red; font-weight:bold; }
</style>
</head>
<body>
<h1>Araç Takip</h1>

<div>
<input type="text" id="aracAdi" placeholder="Araç Adı">
<input type="text" id="plaka" placeholder="Plaka">
<input type="date" id="baslangic">
<input type="date" id="bitis">
<button onclick="ekleArac()">Araç Ekle</button>
</div>

<div id="aracListesi"></div>

<script>
let araclar = [];

function ekleArac() {
    const adi = document.getElementById('aracAdi').value;
    const plaka = document.getElementById('plaka').value;
    const bas = document.getElementById('baslangic').value;
    const bit = document.getElementById('bitis').value;

    if(!adi || !plaka || !bit){ alert("Araç adı, plaka ve bitiş tarihi gerekli!"); return; }

    const arac = { adi, plaka, bas, bit };
    araclar.push(arac);
    localStorage.setItem('araclar', JSON.stringify(araclar));
    goster();
    temizle();
}

function temizle() {
    document.getElementById('aracAdi').value = '';
    document.getElementById('plaka').value = '';
    document.getElementById('baslangic').value = '';
    document.getElementById('bitis').value = '';
}

function goster() {
    const liste = document.getElementById('aracListesi');
    liste.innerHTML = '';
    araclar.forEach((a, i) => {
        const bitisTarih = new Date(a.bitis);
        const bugun = new Date();
        const fark = Math.ceil((bitisTarih - bugun)/(1000*60*60*24));
        const kalanHTML = fark>=0 ? <span class="kalan">${fark} gün kaldı</span> : <span class="uyari">Süresi doldu!</span>;
        
        const div = document.createElement('div');
        div.className = 'arac';
        div.innerHTML = <strong>${a.adi} (${a.plaka})</strong><br>Bitiş: ${a.bitis}<br>${kalanHTML}<br><button onclick="sil(${i})">Sil</button>;
        liste.appendChild(div);

        // Bildirim (uyarı)
        if(fark <=3 && fark>=0){
            if(Notification.permission === "granted") {
                new Notification(${a.adi} (${a.plaka}) süresi ${fark} gün kaldı!);
            }
        }
    });
}

function sil(index){
    araclar.splice(index,1);
    localStorage.setItem('araclar', JSON.stringify(araclar));
    goster();
}

// LocalStorage'dan yükle
if(localStorage.getItem('araclar')){
    araclar = JSON.parse(localStorage.getItem('araclar'));
    goster();
}

// Bildirim izni
if(Notification.permission !== "granted"){
    Notification.requestPermission();
}

</script>
</body>
</html>
